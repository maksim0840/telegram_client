# Пользовательский клиент
telegram_client является дополнением к основнуму клиенту Telegram Desktop версии 5.9.0. Клиент создан для безопасной работы, отправки и полчучения сообщений. Ознакомиться с исходным кодом оригинального клиента можно в ветке telegram-5.9.0 или на официальном GitHub-репозитории [tdesktop](https://github.com/telegramdesktop/tdesktop)

# Функционал:

- Шифрование личных сообщений, диалогов и чатов на несколько человек
- Безопасное формирование криптостойкого ключа шифрования
- Возможность самостоятельно включать и выключать режим шифрования, обновлять ключи
- Зашифрованное сообщение гарантировано имеет отличительную иконку


# Инструкция по началу работы:

![image](https://github.com/user-attachments/assets/8649f24f-8bc4-4ea4-b209-5789487072ec)

1) Создайте общий чат / диалог с пользователем для начала общения (или просто войдите в личные сообщения "Saved Messages")
2) Убедитесь, что все участники чата установили расширение Telegram-клиента, необходимое для шифрования.
3) Для формирования ключа шифрования любой из пользователей должен нажать на кнопку с изображением закрытого замка на верхней панели чата
4) После заврешения процедуры обмена ключами в чате появится сообщение "stop encryption key forming"
5) Все учатники чата получили общей ключ ишфрования и все последующие сообщения, отправленные с клиента в чат, будут зашифрованы.
6) Для деактивации режима шифрования любой из пользователей должен нажать на кнопку с изображением открытого замка на верхней панели чата

# Установка и запуск

[Скачать последнюю версию (Release)](https://github.com/maksim0840/telegram_client/releases/tag/v1.0)


# Сборка исходных файлов пользовательского клиента + рекомендации

Расширенный клиент телеграмма находится в main ветке. Сборка происходит почти так же, как и в оригинальном клиенте. Сборка тяжёлого проекта занимает большое количество времени и ресурсов. Для наиболее эфективной сборки выставите подходящее количество CPU, RAM и выделите достаточное количество памяти на диске для сборки проекта.

**Рекомендации по выставлению CPU, RAM для сборки:**
```
nproc # CPUS (Для проекта рекомендуется выставить на 1-2 ядра меньше, чтобы система не зависла во время сборки)

free -h | awk '/Mem:/ {print $7}' # RAM (Для проекта доступную оперативную память рекомендуется выставить на 1-2 GB меньше, чтобы система не убила процесс из-за нехватки памяти)

```

**Рекомендации по свободной памяти на диске:**

Клиент собирается в 2 этапа: сборка внешних библиотек и компиляция файлов самого проекта. Эти этапы требуют намного больше памяти, чем занимает итоговый результат, т.к. происходит сборка тяжелых библиотек, которые требуют большое количество памяти для временных сборочных данных. Ниже привидены графики занимаемой памяти и примерное время сборки всего проекта.

**Аппаратная конфигурация тестовой среды:**

- CPU: AMD Ryzen 7 3750H (8 ядер, из которых в сборке учавствовало 6)
- RAM: DDR4 3200MHz SODIMM Micron 8GB X 2 (available 11 GB, из которых в сборке учавствовало 10)
- STORAGE (SSD): INTEL SSDPEKNW512G (468 GB, из которых свободны 354 GB)

**Затраты при сборке**

![stage1](https://github.com/user-attachments/assets/9033ebba-0f02-411c-8e00-ab178ac6057d)

![stage2](https://github.com/user-attachments/assets/302ac3fe-1893-4081-a19c-49b6231d5cc8)

- Итоговое время сборки: 5 часов 8 минут
- Итоговый размер проекта: 95 GB
- Максимальное потребление памяти: 121 GB

**Получение api_id и api_hash:**

Для сборки клиента вам нужно знать собственные api_id и api_hash Telegram. Данные значения нужно указать в build-скрипте, который вы запускаете (circle_build.sh или build.sh).
[Инструкция по получению api](https://core.telegram.org/api/obtaining_api_id)

**Инструкция по сборке:**

0) Перед началом сборки должны быть установлены git, gcc, cmake, python, poetry, docker

1) Скачать файлы проекта
```
git clone --recursive https://github.com/maksim0840/telegram_client
```
2) Задать параметры CPU и RAM, удовлетворяющие вашей конфигурации в файле telegram_client/config.env

3) Запустить установку внешних библиотек
```
./telegram_client/Telegram/build/prepare/linux.sh
```

4) Указать свои значения api_id и api_hash в build-скрипте, который вы запускаете (circle_build.sh или build.sh)
   
5) Запустить сборку проекта (circle_build.sh - бесконечный цикл запуска сборки с игнорированием ошибок (использовать, если уверены в корректности всех файлов), build.sh - обычый запуск сборки с остановкой контейнера при возникновении даже незначительных ошибок)
```
./telegram_client/circle_build.sh
```

**После сборки готовый клиент будет находится в папке telegram_client/out/Release**

# Обратная связь

При возникновении ошибок или сбоев буду благодарен, если вы сообщите об этом через [Issues](https://github.com/maksim0840/telegram_client/issues). 
